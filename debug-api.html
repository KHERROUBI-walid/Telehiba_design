<!doctype html>
<html>
  <head>
    <title>Test API Symfony</title>
  </head>
  <body>
    <h1>Test de l'API Symfony</h1>
    <button onclick="testApiRoot()">Test GET /api</button>
    <button onclick="testLogin()">Test POST /api/login</button>
    <button onclick="testApi2()">Test GET /api/produits</button>
    <div id="results"></div>

    <script>
      const API_BASE = "http://127.0.0.1:8000/api";

      function log(message) {
        document.getElementById("results").innerHTML +=
          "<pre>" + message + "</pre>";
      }

      async function testApiRoot() {
        log("üîç Test GET /api...");
        try {
          const response = await fetch(API_BASE, {
            method: "GET",
            headers: {
              Accept: "application/json",
            },
          });

          log(`Status: ${response.status} ${response.statusText}`);
          log(
            `Headers: ${JSON.stringify(Object.fromEntries(response.headers.entries()), null, 2)}`,
          );

          const text = await response.text();
          log(`Response: ${text}`);
        } catch (error) {
          log(`‚ùå Erreur: ${error.message}`);
        }
      }

      async function testLogin() {
        log("üîê Test POST /api/login...");
        try {
          const response = await fetch(API_BASE + "/login", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Accept: "application/json",
            },
            body: JSON.stringify({
              email: "khe.walid59@gmail.com",
              password: "walid2002",
            }),
          });

          log(`Status: ${response.status} ${response.statusText}`);
          log(
            `Headers: ${JSON.stringify(Object.fromEntries(response.headers.entries()), null, 2)}`,
          );

          const text = await response.text();
          log(`Response: ${text}`);
        } catch (error) {
          log(`‚ùå Erreur: ${error.message}`);
        }
      }

      async function testApi2() {
        log("üì¶ Test GET /api/produits...");
        try {
          const response = await fetch(API_BASE + "/produits", {
            method: "GET",
            headers: {
              Accept: "application/json",
            },
          });

          log(`Status: ${response.status} ${response.statusText}`);
          log(
            `Headers: ${JSON.stringify(Object.fromEntries(response.headers.entries()), null, 2)}`,
          );

          const text = await response.text();
          log(`Response: ${text.substring(0, 500)}...`);
        } catch (error) {
          log(`‚ùå Erreur: ${error.message}`);
        }
      }
    </script>
  </body>
</html>
